# Serverokey üöÄ v4.2 ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–º–µ—Å—Ç–æ –ö–æ–¥–∞

**Serverokey** (–°–µ—Ä–≤–µ—Ä-–æ–∫–µ–π) ‚Äî —ç—Ç–æ –∞—Ç–æ–º–∞—Ä–Ω—ã–π, –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ Node.js, —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é LLM (Large Language Models). –ï–≥–æ –≥–ª–∞–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å LLM –∏–∑ "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞" –≤ "–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä–∞", –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç **–ß–¢–û** –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –∞ –Ω–µ **–ö–ê–ö**.

Serverokey –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–µ **"HTML-over-the-wire"**, –Ω–æ —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º, –ø–æ–∑–≤–æ–ª—è—é—â–∏–º —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –µ–¥–∏–Ω–æ–π —Å—Ç—Ä–æ—á–∫–∏ JavaScript –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ.

*   **–ê–≤—Ç–æ—Ä:** Xzdes
*   **–ö–æ–Ω—Ç–∞–∫—Ç:** [xzdes@yandex.ru](mailto:xzdes@yandex.ru)
*   **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** [https://github.com/Xzdes/serverokey](httpss://github.com/Xzdes/serverokey)

---

## üéØ –§–∏–ª–æ—Å–æ—Ñ–∏—è: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–º–µ—Å—Ç–æ –ö–æ–¥–∞

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ LLM –æ—Ç–ª–∏—á–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∫–æ–¥, –Ω–æ —á–∞—Å—Ç–æ –æ—à–∏–±–∞—é—Ç—Å—è –≤ –¥–µ—Ç–∞–ª—è—Ö, —Ç—Ä–µ–±—É—é—â–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. Serverokey —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É, –∑–∞–º–µ–Ω—è—è –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ ‚Äî `manifest.js`.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç LLM —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ —Å–≤–æ–∏—Ö —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö ‚Äî –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö, ‚Äî –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—ã—à–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞.

1.  **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ –ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã:** –í–º–µ—Å—Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î, –≤—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: `{"type": "wise-json", "collection": "users"}`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (—Å JSON –Ω–∞ `wise-json-db`), –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—è –ª–æ–≥–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

2.  **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –õ–æ–≥–∏–∫–∞ (`steps`):** –í–º–µ—Å—Ç–æ `if/else` –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º JS-—Ñ–∞–π–ª–µ, –≤—ã –æ–ø–∏—Å—ã–≤–∞–µ—Ç–µ —Å–ª–æ–∂–Ω—É—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –ø—Ä—è–º–æ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ: `{"if": "receipt.total > 300", "then": [...]}`. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –ª–æ–≥–∏–∫—É –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π –∏ –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º–æ–π.

3.  **–ü–æ–ª–Ω–∞—è –ò–∑–æ–ª—è—Ü–∏—è:** –î–≤–∏–∂–æ–∫ –∞–±—Å—Ç—Ä–∞–≥–∏—Ä—É–µ—Ç –≤—Å—é —Å–ª–æ–∂–Ω—É—é "–æ–±–≤—è–∑–∫—É". –û–Ω —Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç —Ñ–∞–π–ª—ã, –æ–±–Ω–æ–≤–ª—è–µ—Ç DOM –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (—Å–æ—Ö—Ä–∞–Ω—è—è —Ñ–æ–∫—É—Å –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ), —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. LLM –Ω–µ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∏–ª–∏ –æ–ø–∞—Å–Ω—ã–º API.

> **–†–µ–∑—É–ª—å—Ç–∞—Ç:** LLM —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **–µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞** (`manifest.js`), –≥–µ–Ω–µ—Ä–∏—Ä—É—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏ –ª–µ–≥–∫–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## üõ†Ô∏è –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å: –í–∞—à –ø–µ—Ä–≤—ã–π –ø—Ä–æ–µ–∫—Ç

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–∫–∞–∂–µ—Ç, –∫–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–º–µ—Ä (`kassa-app-example`) –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω—É–ª—è.

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–∏–º–µ—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏:
*   `packages/serverokey`: üì¶ –Ø–¥—Ä–æ –¥–≤–∏–∂–∫–∞.
*   `packages/kassa-app-example`:  –ü—Ä–∏–º–µ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ `serverokey`.

```bash
# 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/Xzdes/serverokey.git
cd serverokey

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ –∫–æ—Ä–Ω—è
npm install

# 3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å –ø—Ä–∏–º–µ—Ä–æ–º
cd packages/kassa-app-example

# 4. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ù–∞–ø–æ–ª–Ω–∏—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö wise-json-db –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
npm run seed

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –≥–æ—Ä—è—á–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π –∏ –æ—Ç–ª–∞–¥–∫–æ–π
npm run dev:debug
```–û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3000` –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ!

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —Å –Ω—É–ª—è

```bash
# 1. –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –Ω–µ–µ
mkdir my-app && cd my-app

# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Node.js –ø—Ä–æ–µ–∫—Ç
npm init -y

# 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Serverokey, nodemon –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, wise-json-db
npm install serverokey
npm install nodemon --save-dev
npm install wise-json-db # –ï—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –ë–î

# 4. –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫
mkdir -p app/components app/actions wise-db-data

# 5. –°–æ–∑–¥–∞–µ–º server.js, manifest.js –∏ –¥—Ä—É–≥–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã
#    (—Å–º. kassa-app-example –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞)

# 6. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –≤ package.json
#    "dev": "nodemon server.js",
#    "validate": "serverokey-validate"
```

---

## üíª –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–†–∞–±–æ—á–∏–π —Ü–∏–∫–ª —Å Serverokey –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç.

1.  **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
    –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `nodemon` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞. –†–µ–∂–∏–º `:debug` –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –±—Ä–∞—É–∑–µ—Ä–∞, —á—Ç–æ –±–µ—Å—Ü–µ–Ω–Ω–æ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
    ```bash
    npm run dev:debug
    ```
2.  **–í–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**
    –†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `manifest.js`, –¥–æ–±–∞–≤–ª—è–π—Ç–µ –∏ –º–µ–Ω—è–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `app/components/`, —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —ç–∫—à–µ–Ω—ã.
3.  **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª**
    `nodemon` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
4.  **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å**
    –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä. –û–Ω –Ω–∞–π–¥–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞ –≤–∞—Å.
    ```bash
    npm run validate
    ```
---

## üìñ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ `manifest.js`

`manifest.js` ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### `globals`
–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤–æ –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–∞—Ö.

```javascript
globals: {
  appName: "–ú–æ—è –ö–∞—Å—Å–∞",
  // –î–µ–ª–∞–µ—Ç –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä 'user' –¥–æ—Å—Ç—É–ø–Ω—ã–º –≥–ª–æ–±–∞–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–∞—Ö
  injectData: ['user'] 
}
```

### `connectors`
–û–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö. **–≠—Ç–æ –∫–ª—é—á–µ–≤–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å Serverokey!** –í—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è, –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏–≤ `type`.

#### –¢–∏–ø: `wise-json` (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)
–•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –±—ã—Å—Ç—Ä–æ–π –∏ –Ω–∞–¥–µ–∂–Ω–æ–π –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö `wise-json-db`. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

```javascript
receipt: {
  type: 'wise-json',
  collection: 'receipt', // –ò–º—è –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ wise-json-db
  initialState: { 
    items: [],
    discountPercent: 10,
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  }
}
```

#### –¢–∏–ø: `json`
–•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –ø—Ä–æ—Å—Ç–æ–º JSON-—Ñ–∞–π–ª–µ –≤ –ø–∞–ø–∫–µ `app/data/`. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ.

```javascript
positions: {
  type: 'json',
  // initial state –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω –≤ app/data/positions.json
  initialState: { items: [...] } 
}
```

#### –¢–∏–ø: `in-memory`
–•—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –î–∞–Ω–Ω—ã–µ **—Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è** –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–µ UI (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞).

```javascript
viewState: {
  type: 'in-memory',
  initialState: { query: '', filtered: [] }
}
```

### `components`
–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. –°—Ç–∏–ª–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–¥–µ—Å—å, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (scoped).

```javascript
components: {
  mainLayout: 'main-layout.html',
  receipt: {
    template: 'receipt.html',   // –®–∞–±–ª–æ–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    style: 'receipt.css'        // –°–≤—è–∑–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å—Ç–∏–ª–µ–π
  }
}
```

### `routes`
–°–≤—è–∑—ã–≤–∞–µ—Ç URL –∏ HTTP-–º–µ—Ç–æ–¥ —Å –¥–µ–π—Å—Ç–≤–∏–µ–º –≤ —Å–∏—Å—Ç–µ–º–µ.

#### `type: 'view'`
–†–µ–Ω–¥–µ—Ä–∏—Ç —Ü–µ–ª—É—é HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É.
```javascript
'GET /': {
  type: 'view',
  layout: 'mainLayout',
  reads: ['user', 'receipt'], 
  inject: { 'placeholderName': 'componentName' }
}
```

#### `type: 'action'`
–í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–µ—Ä–≤–µ—Ä–Ω—É—é –ª–æ–≥–∏–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π HTML-—Ñ—Ä–∞–≥–º–µ–Ω—Ç.

**`steps` (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –∏ —Å–∞–º—ã–π –º–æ—â–Ω—ã–π —Å–ø–æ—Å–æ–±):**
–ú–∞—Å—Å–∏–≤ —à–∞–≥–æ–≤ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Å–ª–æ–∂–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è JS.

```javascript
'POST /action/addItem': {
  type: 'action',
  steps: [
    // 1. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
    { "set": "context.productToAdd", "to": "positions.items.find(p => p.id == body.id)" },
    { "set": "context.itemInReceipt", "to": "receipt.items.find(i => i.id == body.id)" },
    // 2. –í—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å–ª–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É
    {
      "if": "context.itemInReceipt",
      "then": [ { "set": "context.itemInReceipt.quantity", "to": "context.itemInReceipt.quantity + 1" } ],
      "else": [
        { "set": "context.productToAdd.quantity", "to": "1" },
        { "set": "receipt.items", "to": "receipt.items.concat([context.productToAdd])" }
      ]
    },
    // 3. –í—ã–∑–≤–∞—Ç—å "–º–∞–∫—Ä–æ—Å" - –¥—Ä—É–≥–æ–π –º–∞—Å—Å–∏–≤ —à–∞–≥–æ–≤ –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞
    ...require('./app/actions/recalculateReceipt.js')
  ],
  reads: ['positions', 'receipt'], // –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
  writes: ['receipt'],            // –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  update: 'receipt'               // –ö–∞–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
}
```
**–î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã (–º–µ–Ω–µ–µ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–µ):**
*   **`handler`:** –°—Å—ã–ª–∫–∞ –Ω–∞ JS-—Ñ–∞–π–ª –≤ `app/actions/` –¥–ª—è —Å–ª–æ–∂–Ω–æ–π –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ª–æ–≥–∏–∫–∏.
*   **`manipulate`:** –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (push, remove). –ë—ã–ª–æ –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `steps` –¥–ª—è –±–æ–ª—å—à–µ–π –≥–∏–±–∫–æ—Å—Ç–∏.

---

## ÌÖú –®–∞–±–ª–æ–Ω—ã –∏ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å

–î–≤–∏–∂–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **Mustache.js** –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å–≤–æ–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã.

*   **–ê—Ç—Ä–∏–±—É—Ç—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:**
    *   `atom-action="METHOD /url"`: –£–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π —ç–∫—à–µ–Ω –≤—ã–∑–≤–∞—Ç—å.
    *   `atom-target="#css-selector"`: –£–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–±–Ω–æ–≤–∏—Ç—å.
    *   `atom-event="input"`: (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –£–∫–∞–∑—ã–≤–∞–µ—Ç, –ø–æ –∫–∞–∫–æ–º—É —Å–æ–±—ã—Ç–∏—é –≤—ã–∑—ã–≤–∞—Ç—å —ç–∫—à–µ–Ω (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `click` –∏–ª–∏ `submit`).
*   **–£—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥: `atom-if`**
    –ê—Ç—Ä–∏–±—É—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM, –µ—Å–ª–∏ JavaScript-—É—Å–ª–æ–≤–∏–µ –≤ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–∏ –ª–æ–∂–Ω–æ.
    ```html
    <div class="empty-state" atom-if="!receipt.items.length">–ß–µ–∫ –ø—É—Å—Ç</div>
    ```

---

## üîÆ –ë—É–¥—É—â–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

*   [ ] **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö `auth` —Ä–æ—É—Ç–æ–≤ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–ª–æ–≥–∏–Ω–∞.
*   [ ] **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö:** –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è **PostgreSQL**, **SQLite** –∏ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤.
*   [ ] **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π CLI-–ø–æ–º–æ—â–Ω–∏–∫:** –£—Ç–∏–ª–∏—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (`npm run new component ...`) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è "–∞—Ç–æ–º–æ–≤" –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç `manifest.js`.
*   [ ] **–î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–µ WebSocket'—ã:** –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ –∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.

---

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —á–µ–ª–æ–≤–µ–∫–∞ –∏ –º–∞—à–∏–Ω—ã, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–¥–µ–∂–Ω—ã—Ö –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –ë—É–¥—É —Ä–∞–¥ –≤–∞—à–∏–º –∏–¥–µ—è–º –∏ –≤–∫–ª–∞–¥—É!

**Xzdes**