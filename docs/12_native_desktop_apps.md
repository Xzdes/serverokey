### Файл 3 (Новый): `docs/12_native_desktop_apps.md`

```markdown
# 12. Режим Запуска: Веб-сервер vs Нативное Приложение

Одним из ключевых преимуществ Serverokey является его способность работать в двух разных режимах, переключение между которыми осуществляется одной строкой в `manifest.js`. Это позволяет разрабатывать приложение один раз и запускать его как традиционный веб-сервис или как легковесное кросс-платформенное десктопное приложение.

## Конфигурация в `manifest.js`

За режим запуска отвечает новая корневая секция `launch`. Если эта секция отсутствует, по умолчанию используется режим `"server"`.

```javascript
// manifest.js
module.exports = {
  // ... другие секции ...
  
  "launch": {
    "mode": "native", // или "server"
    "window": {
      // эти настройки применяются только в режиме "native"
      "title": "Мое Приложение",
      "width": 1280,
      "height": 800,
      "devtools": false 
    }
  }
};
```

### Свойство `mode`

*   `"server"` (по умолчанию): Serverokey запускает стандартный веб-сервер Node.js на порту, указанном в `process.env.PORT` или по умолчанию на `3000`. Приложение доступно из любого браузера по адресу `http://localhost:3000`.
*   `"native"`: Serverokey использует **Puppeteer** для запуска локальной, изолированной версии Chromium, в которой открывается ваше приложение. Это создает видимость нативного десктопного приложения.

### Секция `window` (только для `mode: "native"`)

Эта секция позволяет настроить внешний вид окна Chromium.

*   `title` (string): Заголовок, который будет отображаться в верхней части окна и в панели задач.
*   `width` (number): Начальная ширина окна в пикселях.
*   `height` (number): Начальная высота окна в пикселях.
*   `devtools` (boolean): Если `true`, то вместе с окном приложения автоматически откроются Инструменты разработчика Chromium. Это крайне полезно для отладки.

## Как работает Нативный Режим "Под Капотом"

Когда вы выбираете `mode: "native"`, движок выполняет следующую последовательность действий:

1.  **"Сервер-в-коробке":** Вместо того чтобы занимать публичный порт `3000`, движок находит случайный свободный порт и запускает на нем внутренний веб-сервер, доступный **только с вашего компьютера** (`127.0.0.1`).
2.  **Запуск Chromium:** Движок использует библиотеку `Puppeteer`, которая поставляется с собственной, протестированной версией Chromium. Это гарантирует, что приложение будет выглядеть и работать одинаково на любой машине, независимо от установленных в системе браузеров.
3.  **Открытие Приложения:** Puppeteer запускает окно Chromium в "режиме приложения" (без вкладок, адресной строки и кнопок управления) и открывает в нем URL внутреннего сервера (например, `http://127.0.0.1:54321`).
4.  **Синхронизация Жизненного Цикла:** Движок следит за состоянием окна. Как только вы закрываете окно приложения, Node.js процесс Serverokey также корректно завершает свою работу.

## Преимущества Нативного Режима

*   **Кросс-платформенность:** Ваше приложение будет работать на Windows, macOS и Linux без изменений в коде.
*   **Офлайн-Работа:** Так как и клиент, и сервер находятся на одной машине, приложение может работать без подключения к интернету (при условии, что оно не использует шаги `http:get` к внешним ресурсам).
*   **Простота Разработки:** Вам не нужно изучать Electron, Tauri или другие фреймворки для десктопной разработки. Вы продолжаете описывать свое приложение декларативно в `manifest.js`.
*   **Предсказуемость:** Вы точно знаете, в какой версии браузерного движка будет работать ваше приложение, что избавляет от проблем с совместимостью.

Этот гибридный подход дает вам гибкость в развертывании вашего приложения, не усложняя при этом процесс разработки.